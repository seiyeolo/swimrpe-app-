<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SwimRPE - ìˆ˜ì˜ ê°•ë„ ì¸¡ì • ì•± v1.0</title>
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="SwimRPE">
    <meta name="theme-color" content="#0ea5e9">
    <meta name="description" content="ìˆ˜ì˜ ê°•ë„ë¥¼ ê³¼í•™ì ìœ¼ë¡œ ì¸¡ì •í•˜ê³  ê¸°ë¡í•˜ëŠ” PWA ì•±">
    
    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="manifest.json">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0ea5e9;
            --primary-dark: #0284c7;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --background: #fafbff;
            --surface: #ffffff;
            --surface-alt: #f8fafc;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #94a3b8;
            --border: #e2e8f0;
            --border-light: #f1f5f9;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
            --radius: 16px;
            --radius-sm: 8px;
            --radius-lg: 24px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, var(--background) 0%, #e0f2fe 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .app-container {
            max-width: 430px;
            margin: 0 auto;
            background: var(--surface);
            min-height: 100vh;
            position: relative;
            box-shadow: var(--shadow-xl);
            overflow-x: hidden;
        }

        /* PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ */
        .install-prompt {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary);
            color: white;
            padding: 12px 20px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            z-index: 1001;
            display: none;
            animation: slideUp 0.3s ease-out;
        }

        .install-prompt.show {
            display: block;
        }

        .install-prompt button {
            background: white;
            color: var(--primary);
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            margin-left: 12px;
            cursor: pointer;
        }

        @keyframes slideUp {
            from {
                transform: translateX(-50%) translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }

        /* ì˜¤í”„ë¼ì¸ ìƒíƒœ í‘œì‹œ */
        .offline-indicator {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--warning);
            color: white;
            text-align: center;
            padding: 8px;
            font-size: 14px;
            font-weight: 600;
            display: none;
            z-index: 1002;
        }

        .offline-indicator.show {
            display: block;
        }

        /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ë“¤ ìœ ì§€ */
        .app-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            padding: 60px 24px 40px;
            color: white;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .app-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 20%, rgba(255,255,255,0.2) 0%, transparent 50%);
        }

        .app-header h1 {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
            letter-spacing: -0.5px;
        }

        .app-header p {
            font-size: 16px;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            font-weight: 500;
        }

        /* ë©”ì¸ ì»¨í…ì¸  */
        .main-content {
            padding: 32px 24px 120px;
        }

        /* ì¹´ë“œ */
        .card {
            background: var(--surface);
            border-radius: var(--radius-lg);
            padding: 32px 28px;
            margin-bottom: 24px;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        }

        .card h2 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 24px;
            color: var(--text-primary);
        }

        .card h3 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        /* ì˜¨ë³´ë”© ì„¹ì…˜ */
        .onboarding-section {
            background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);
            border: 2px solid var(--primary);
        }

        .onboarding-section::before {
            background: var(--primary);
        }

        .feature-grid {
            display: grid;
            gap: 16px;
            margin-top: 24px;
        }

        .feature-item {
            display: flex;
            align-items: flex-start;
            padding: 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: var(--radius);
            gap: 16px;
        }

        .feature-icon {
            flex-shrink: 0;
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            font-weight: 700;
        }

        .feature-content h4 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .feature-content p {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
        .tab-navigation {
            display: flex;
            background: var(--surface-alt);
            border-radius: var(--radius);
            padding: 6px;
            margin-bottom: 32px;
            border: 1px solid var(--border);
        }

        .tab-btn {
            flex: 1;
            padding: 16px 8px;
            background: transparent;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
            position: relative;
        }

        .tab-btn.active {
            background: white;
            color: var(--primary);
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .tab-btn:hover:not(.active) {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.7);
        }

        /* íƒ­ ì»¨í…ì¸  */
        .tab-content {
            display: none;
            animation: fadeInUp 0.5s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* í†µê³„ ê·¸ë¦¬ë“œ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 28px 24px;
            border-radius: var(--radius-lg);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%);
            transform: rotate(45deg);
        }

        .stat-value {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }

        /* ìˆ˜ì˜ íŠ¹í™” ì„¹ì…˜ */
        .swimming-section {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 2px solid var(--info);
        }

        .swimming-section::before {
            background: var(--info);
        }

        .stroke-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 24px 0;
        }

        .stroke-item {
            padding: 16px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            background: var(--surface);
        }

        .stroke-item:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .stroke-item.selected {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }

        .stroke-name {
            font-weight: 600;
            font-size: 14px;
        }

        .session-type-selector {
            display: flex;
            gap: 12px;
            margin: 24px 0;
            flex-wrap: wrap;
        }

        .session-type-item {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            background: var(--surface);
            font-size: 14px;
            font-weight: 600;
        }

        .session-type-item:hover {
            border-color: var(--secondary);
        }

        .session-type-item.selected {
            border-color: var(--secondary);
            background: var(--secondary);
            color: white;
        }

        /* RPE ì²™ë„ */
        .rpe-scale {
            display: grid;
            gap: 12px;
            margin-top: 24px;
        }

        .rpe-item {
            display: flex;
            align-items: center;
            padding: 20px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--surface);
            position: relative;
        }

        .rpe-item:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .rpe-item.selected {
            border-color: var(--primary);
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            transform: scale(1.02);
            box-shadow: var(--shadow-lg);
        }

        .rpe-number {
            font-size: 28px;
            font-weight: 800;
            min-width: 50px;
            margin-right: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .rpe-description {
            flex: 1;
        }

        .rpe-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .rpe-detail {
            font-size: 14px;
            opacity: 0.8;
            line-height: 1.4;
        }

        .rpe-swimming-tip {
            font-size: 13px;
            opacity: 0.7;
            font-style: italic;
            margin-top: 4px;
        }

        /* í¼ ìš”ì†Œ */
        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .form-input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            font-size: 16px;
            transition: all 0.3s ease;
            background: var(--surface);
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(14, 165, 233, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 120px;
            font-family: inherit;
        }

        /* ë²„íŠ¼ */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 16px 32px;
            border: none;
            border-radius: var(--radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            gap: 8px;
            font-family: inherit;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--surface-alt);
            color: var(--text-primary);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--border-light);
            border-color: var(--primary);
        }

        .btn-full {
            width: 100%;
        }

        /* í”¼ë“œë°± ì‹œìŠ¤í…œ */
        .feedback-section {
            background: linear-gradient(135deg, #fef3c7 0%, #fed7aa 100%);
            border: 2px solid var(--warning);
        }

        .feedback-section::before {
            background: var(--warning);
        }

        .feedback-quick {
            display: flex;
            gap: 12px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .feedback-item {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            background: var(--surface);
            font-size: 14px;
            font-weight: 600;
        }

        .feedback-item:hover {
            border-color: var(--warning);
        }

        .feedback-item.selected {
            border-color: var(--warning);
            background: var(--warning);
            color: white;
        }

        /* ê¸°ë¡ ì•„ì´í…œ */
        .record-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 24px;
            background: var(--surface-alt);
            border-radius: var(--radius);
            margin-bottom: 16px;
            border-left: 4px solid var(--primary);
            transition: all 0.3s ease;
        }

        .record-item:hover {
            background: var(--border-light);
            transform: translateX(4px);
        }

        .record-info {
            flex: 1;
        }

        .record-info h4 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 6px;
            color: var(--text-primary);
        }

        .record-info p {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .record-tags {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        .record-tag {
            background: var(--primary);
            color: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
        }

        .record-rpe {
            font-size: 32px;
            font-weight: 800;
            color: var(--primary);
            min-width: 70px;
            text-align: center;
        }

        /* ìƒíƒœ ë©”ì‹œì§€ */
        .status-message {
            margin-top: 20px;
            padding: 16px 20px;
            border-radius: var(--radius);
            text-align: center;
            font-weight: 500;
            font-size: 14px;
        }

        .status-success {
            background: #dcfce7;
            color: #166534;
            border: 1px solid #bbf7d0;
        }

        .status-error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }

        .status-loading {
            background: #e0f2fe;
            color: #0e7490;
            border: 1px solid #bae6fd;
        }

        /* ë¹ˆ ìƒíƒœ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state h3 {
            font-size: 20px;
            margin-bottom: 12px;
            color: var(--text-primary);
        }

        .empty-state p {
            font-size: 16px;
            margin-bottom: 24px;
        }

        /* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 430px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--border);
            padding: 16px 20px 20px;
            z-index: 1000;
        }

        .nav-tabs {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .nav-tab {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px 16px;
            color: var(--text-muted);
            text-decoration: none;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            background: none;
            border-radius: var(--radius);
        }

        .nav-tab.active {
            color: var(--primary);
            background: rgba(14, 165, 233, 0.1);
        }

        .nav-icon {
            width: 28px;
            height: 28px;
            margin-bottom: 6px;
            stroke: currentColor;
            fill: none;
            stroke-width: 2;
        }

        /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #f3f4f6;
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 480px) {
            .app-container {
                max-width: 100%;
            }
            
            .main-content {
                padding: 24px 16px 120px;
            }
            
            .card {
                padding: 24px 20px;
                margin-bottom: 20px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .stroke-selector {
                grid-template-columns: 1fr;
            }

            .session-type-selector {
                flex-direction: column;
            }

            .session-type-item {
                flex: none;
            }
        }
    </style>
</head>
<body>
    <!-- ì˜¤í”„ë¼ì¸ ìƒíƒœ í‘œì‹œ -->
    <div class="offline-indicator" id="offline-indicator">
        ì˜¤í”„ë¼ì¸ ëª¨ë“œ - ë°ì´í„°ëŠ” ë¡œì»¬ì— ì €ì¥ë©ë‹ˆë‹¤
    </div>

    <!-- PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ -->
    <div class="install-prompt" id="install-prompt">
        SwimRPEë¥¼ í™ˆ í™”ë©´ì— ì„¤ì¹˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
        <button onclick="installApp()">ì„¤ì¹˜</button>
        <button onclick="dismissInstall()">ë‚˜ì¤‘ì—</button>
    </div>

    <div class="app-container">
        <header class="app-header">
            <h1>SwimRPE</h1>
            <p>ìˆ˜ì˜ ê°•ë„ë¥¼ ê³¼í•™ì ìœ¼ë¡œ ì¸¡ì •í•˜ê³  ê¸°ë¡í•˜ì„¸ìš”</p>
        </header>

        <main class="main-content">
            <!-- ì˜¨ë³´ë”©/êµìœ¡ íƒ­ -->
            <div id="guide-tab" class="tab-content active">
                <div class="card onboarding-section">
                    <h2>ìˆ˜ì˜ê³¼ RPE ì¸¡ì •ì˜ ê³¼í•™</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 24px; line-height: 1.6;">
                        RPE(Rating of Perceived Exertion)ëŠ” 1960ë…„ëŒ€ ìŠ¤ì›¨ë´ì˜ ìš´ë™ìƒë¦¬í•™ì Gunnar Borgê°€ ê°œë°œí•œ 
                        <strong>ê³¼í•™ì ìœ¼ë¡œ ê²€ì¦ëœ</strong> ìš´ë™ê°•ë„ ì¸¡ì • ë°©ë²•ì…ë‹ˆë‹¤. íŠ¹íˆ ìˆ˜ì˜ì—ì„œëŠ” ì‹¬ë°•ìˆ˜ ì¸¡ì •ì´ 
                        ì–´ë ¤ìš´ ìˆ˜ì¤‘ í™˜ê²½ì˜ íŠ¹ì„±ìƒ RPEê°€ ë”ìš± ì¤‘ìš”í•œ ì˜ë¯¸ë¥¼ ê°–ìŠµë‹ˆë‹¤.
                    </p>
                    
                    <div class="feature-grid">
                        <div class="feature-item">
                            <div class="feature-icon">ğŸ§¬</div>
                            <div class="feature-content">
                                <h4>ìƒë¦¬í•™ì  ì •í™•ì„±</h4>
                                <p>RPEëŠ” ì‹¤ì œ ì‹¬ë°•ìˆ˜, ì –ì‚° ë†ë„ì™€ 95% ì´ìƒì˜ ë†’ì€ ìƒê´€ê´€ê³„ë¥¼ ë³´ì…ë‹ˆë‹¤. ìˆ˜ì˜ ì‹œ ì²´ê° ê°•ë„ê°€ ì‹¤ì œ ìš´ë™ ë¶€í•˜ë¥¼ ì •í™•íˆ ë°˜ì˜í•©ë‹ˆë‹¤.</p>
                            </div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">ğŸŠ</div>
                            <div class="feature-content">
                                <h4>ìˆ˜ì˜ íŠ¹í™” ì¸¡ì •</h4>
                                <p>ë¬¼ì˜ ì €í•­ê³¼ ë¶€ë ¥ìœ¼ë¡œ ì¸í•´ ìˆ˜ì˜ì€ ë…íŠ¹í•œ ìš´ë™ í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤. RPEëŠ” ì´ëŸ¬í•œ ìˆ˜ì¤‘ í™˜ê²½ì—ì„œ ê°€ì¥ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ê°•ë„ ì§€í‘œì…ë‹ˆë‹¤.</p>
                            </div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">ğŸ“Š</div>
                            <div class="feature-content">
                                <h4>ì„±ê³¼ í–¥ìƒ ë„êµ¬</h4>
                                <p>ë™ì¼í•œ ê±°ë¦¬ë¥¼ ìˆ˜ì˜í•  ë•Œ RPEê°€ ì ì§„ì ìœ¼ë¡œ ê°ì†Œí•œë‹¤ë©´, ì´ëŠ” ìˆ˜ì˜ ì‹¤ë ¥ê³¼ ì²´ë ¥ì´ í–¥ìƒë˜ì—ˆë‹¤ëŠ” ê°ê´€ì  ì¦ê±°ì…ë‹ˆë‹¤.</p>
                            </div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">âš ï¸</div>
                            <div class="feature-content">
                                <h4>ë¶€ìƒ ì˜ˆë°©</h4>
                                <p>ê³¼ë„í•œ í›ˆë ¨ ê°•ë„ë¥¼ ì¡°ê¸°ì— ê°ì§€í•˜ì—¬ ì–´ê¹¨ ë¶€ìƒ, ê³¼í›ˆë ¨ ì¦í›„êµ° ë“± ìˆ˜ì˜ ê´€ë ¨ ë¶€ìƒì„ ì˜ˆë°©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 32px; padding: 20px; background: rgba(59, 130, 246, 0.1); border-radius: var(--radius); border-left: 4px solid var(--info);">
                        <h4 style="color: var(--info); margin-bottom: 12px;">ì™œ ë§¤ì¼ ê¸°ë¡í•´ì•¼ í• ê¹Œìš”?</h4>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                            ìˆ˜ì˜ ì‹¤ë ¥ í–¥ìƒê³¼ ê±´ê°• ê´€ë¦¬ë¥¼ ìœ„í•´ì„œëŠ” <strong>ì¼ê´€ëœ ë°ì´í„° ì¶•ì </strong>ì´ í•„ìˆ˜ì…ë‹ˆë‹¤. 
                            ë§¤ì¼ì˜ RPE ê¸°ë¡ì€ ê°œì¸ì˜ ìš´ë™ íŒ¨í„´ì„ íŒŒì•…í•˜ê³ , ìµœì ì˜ í›ˆë ¨ ê°•ë„ë¥¼ ì°¾ì•„ë‚´ë©°, 
                            ê¸°ë¡ ë‹¨ì¶•ì„ ìœ„í•œ ê³¼í•™ì  ê·¼ê±°ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ë‹¨ 2ì£¼ë§Œ ê¾¸ì¤€íˆ ê¸°ë¡í•´ë„ ë†€ë¼ìš´ ì¸ì‚¬ì´íŠ¸ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!
                        </p>
                    </div>

                    <button class="btn btn-primary btn-full" onclick="switchTab('home')" style="margin-top: 24px;">
                        ì‹œì‘í•˜ê¸° - ë‚˜ì˜ ìˆ˜ì˜ ì—¬ì •ì„ ê¸°ë¡í•´ë³´ì„¸ìš”
                    </button>
                </div>
            </div>

            <!-- í™ˆ ëŒ€ì‹œë³´ë“œ -->
            <div id="home-tab" class="tab-content">
                <div class="tab-navigation">
                    <button class="tab-btn active" onclick="switchSubTab('dashboard')">ëŒ€ì‹œë³´ë“œ</button>
                    <button class="tab-btn" onclick="switchSubTab('guide')">RPE ê°€ì´ë“œ</button>
                </div>

                <div id="dashboard-subtab" class="subtab-content">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="today-avg-rpe">0</div>
                            <div class="stat-label">ì˜¤ëŠ˜ í‰ê·  RPE</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="today-sessions">0</div>
                            <div class="stat-label">ì˜¤ëŠ˜ ìˆ˜ì˜ ì„¸ì…˜</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="weekly-consistency">0%</div>
                            <div class="stat-label">ì£¼ê°„ ì¼ê´€ì„±</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="streak-days">0ì¼</div>
                            <div class="stat-label">ì—°ì† ê¸°ë¡</div>
                        </div>
                    </div>

                    <div class="card">
                        <h3>ìµœê·¼ ìˆ˜ì˜ ê¸°ë¡</h3>
                        <div id="recent-records">
                            <div class="status-loading">
                                <div class="loading-spinner"></div>
                                ìµœê·¼ ê¸°ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                            </div>
                        </div>
                    </div>
                </div>

                <div id="guide-subtab" class="subtab-content" style="display: none;">
                    <div class="card swimming-section">
                        <h3>ìˆ˜ì˜ RPE ì²™ë„ ê°€ì´ë“œ</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">
                            ìˆ˜ì˜ í™˜ê²½ì— íŠ¹í™”ëœ RPE ì²™ë„ì…ë‹ˆë‹¤. ê° ê°•ë„ë³„ë¡œ ìˆ˜ì˜ ìƒí™©ì— ë§ëŠ” ì„¤ëª…ì„ ì°¸ê³ í•˜ì„¸ìš”.
                        </p>
                        <div id="guide-rpe-scale">
                            <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- ìš´ë™ ê¸°ë¡ ì…ë ¥ -->
            <div id="input-tab" class="tab-content">
                <div class="card swimming-section">
                    <h2>ìˆ˜ì˜ ì„¸ì…˜ ê¸°ë¡</h2>
                    
                    <form id="swimming-form">
                        <div class="form-group">
                            <label class="form-label">ìˆ˜ì˜ ì˜ë²•</label>
                            <div class="stroke-selector" id="stroke-selector">
                                <div class="stroke-item" data-stroke="ììœ í˜•">
                                    <div class="stroke-name">ììœ í˜•</div>
                                </div>
                                <div class="stroke-item" data-stroke="ë°°ì˜">
                                    <div class="stroke-name">ë°°ì˜</div>
                                </div>
                                <div class="stroke-item" data-stroke="í‰ì˜">
                                    <div class="stroke-name">í‰ì˜</div>
                                </div>
                                <div class="stroke-item" data-stroke="ì ‘ì˜">
                                    <div class="stroke-name">ì ‘ì˜</div>
                                </div>
                                <div class="stroke-item" data-stroke="í˜¼ì˜">
                                    <div class="stroke-name">í˜¼ì˜</div>
                                </div>
                                <div class="stroke-item" data-stroke="ê¸°íƒ€">
                                    <div class="stroke-name">ê¸°íƒ€</div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">ì„¸ì…˜ ìœ í˜•</label>
                            <div class="session-type-selector" id="session-type-selector">
                                <div class="session-type-item" data-session="ì›œì—…">ì›œì—…</div>
                                <div class="session-type-item" data-session="ë©”ì¸">ë©”ì¸ ì„¸íŠ¸</div>
                                <div class="session-type-item" data-session="ì¿¨ë‹¤ìš´">ì¿¨ë‹¤ìš´</div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">ìš´ë™ ë‚ ì§œ</label>
                            <input type="date" id="swim-date" class="form-input" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label">ìˆ˜ì˜ ê±°ë¦¬ (ì„ íƒì‚¬í•­)</label>
                            <input type="number" id="swim-distance" class="form-input" placeholder="ë¯¸í„° ë‹¨ìœ„ë¡œ ì…ë ¥ (ì˜ˆ: 1000)">
                        </div>

                        <div class="form-group">
                            <label class="form-label">ìš´ë™ ì‹œê°„ëŒ€</label>
                            <select id="swim-time" class="form-input" required>
                                <option value="">ì‹œê°„ëŒ€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                                <option value="ìƒˆë²½">ìƒˆë²½ (05:00-08:00)</option>
                                <option value="ì˜¤ì „">ì˜¤ì „ (08:00-12:00)</option>
                                <option value="ì˜¤í›„">ì˜¤í›„ (12:00-18:00)</option>
                                <option value="ì €ë…">ì €ë… (18:00-22:00)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">RPE ê°•ë„ ì„ íƒ</label>
                            <div class="rpe-selector">
                                <div class="rpe-scale" id="rpe-scale">
                                    <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">ìˆ˜ì˜ ë©”ëª¨ (ì„ íƒì‚¬í•­)</label>
                            <textarea id="swim-memo" class="form-input form-textarea" 
                                      placeholder="ì˜¤ëŠ˜ ìˆ˜ì˜ì— ëŒ€í•œ ëŠë‚Œ, ë¬¼ ìƒíƒœ, ì»¨ë””ì…˜ ë“±ì„ ììœ ë¡­ê²Œ ê¸°ë¡í•´ë³´ì„¸ìš”"></textarea>
                        </div>

                        <button type="submit" class="btn btn-primary btn-full">
                            ìˆ˜ì˜ ê¸°ë¡ ì €ì¥í•˜ê¸°
                        </button>
                    </form>

                    <div id="input-status"></div>
                </div>

                <!-- í”¼ë“œë°± ìˆ˜ì§‘ -->
                <div class="card feedback-section">
                    <h3>ë¹ ë¥¸ í”¼ë“œë°±</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 16px;">
                        ë°©ê¸ˆ ì…ë ¥í•˜ì‹  RPEê°€ ì‹¤ì œ ëŠë‚€ ê°•ë„ì™€ ì–¼ë§ˆë‚˜ ì¼ì¹˜í–ˆë‚˜ìš”?
                    </p>
                    <div class="feedback-quick" id="feedback-selector">
                        <div class="feedback-item" data-feedback="perfect">ì™„ë²½ ì¼ì¹˜</div>
                        <div class="feedback-item" data-feedback="good">ê±°ì˜ ë§ìŒ</div>
                        <div class="feedback-item" data-feedback="okay">ë³´í†µ</div>
                        <div class="feedback-item" data-feedback="off">ì¢€ ë‹¤ë¦„</div>
                    </div>
                    <div id="feedback-status"></div>
                </div>
            </div>

            <!-- ê¸°ë¡ ì¡°íšŒ -->
            <div id="records-tab" class="tab-content">
                <div class="card">
                    <div style="display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap;">
                        <input type="text" id="search-records" class="form-input" 
                               placeholder="ì˜ë²•ì´ë‚˜ ë©”ëª¨ë¡œ ê²€ìƒ‰..." style="flex: 2; min-width: 200px;">
                        <select id="filter-stroke" class="form-input" style="flex: 1; min-width: 120px;">
                            <option value="">ì „ì²´ ì˜ë²•</option>
                            <option value="ììœ í˜•">ììœ í˜•</option>
                            <option value="ë°°ì˜">ë°°ì˜</option>
                            <option value="í‰ì˜">í‰ì˜</option>
                            <option value="ì ‘ì˜">ì ‘ì˜</option>
                            <option value="í˜¼ì˜">í˜¼ì˜</option>
                        </select>
                    </div>
                </div>

                <div id="records-list">
                    <div class="status-loading">
                        <div class="loading-spinner"></div>
                        ìˆ˜ì˜ ê¸°ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                    </div>
                </div>
            </div>

            <!-- í†µê³„ ë¶„ì„ -->
            <div id="stats-tab" class="tab-content">
                <div class="card">
                    <h3>ìˆ˜ì˜ ë¶„ì„</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="total-sessions">0</div>
                            <div class="stat-label">ì´ ìˆ˜ì˜ ì„¸ì…˜</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="avg-rpe-all">0</div>
                            <div class="stat-label">ì „ì²´ í‰ê·  RPE</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="favorite-stroke">-</div>
                            <div class="stat-label">ì„ í˜¸ ì˜ë²•</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="best-time">-</div>
                            <div class="stat-label">ìµœì  ì‹œê°„ëŒ€</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>ì˜ë²•ë³„ RPE ë¶„í¬</h3>
                    <div id="stroke-distribution"></div>
                </div>

                <div class="card">
                    <h3>ì‹œê°„ëŒ€ë³„ ìˆ˜ì˜ íŒ¨í„´</h3>
                    <div id="time-distribution"></div>
                </div>

                <div class="card">
                    <h3>ì‹œìŠ¤í…œ ìƒíƒœ</h3>
                    <button class="btn btn-secondary btn-full" onclick="checkServerHealth()">
                        ì„œë²„ ì—°ê²° ìƒíƒœ í™•ì¸
                    </button>
                    <div id="server-status"></div>
                </div>
            </div>
        </main>

        <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
        <nav class="bottom-nav">
            <div class="nav-tabs">
                <button class="nav-tab" onclick="switchTab('guide')">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                    ê°€ì´ë“œ
                </button>
                <button class="nav-tab active" onclick="switchTab('home')">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                    </svg>
                    í™ˆ
                </button>
                <button class="nav-tab" onclick="switchTab('input')">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 6v6l4 2"/>
                    </svg>
                    ê¸°ë¡
                </button>
                <button class="nav-tab" onclick="switchTab('records')">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                    </svg>
                    ëª©ë¡
                </button>
                <button class="nav-tab" onclick="switchTab('stats')">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <path d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                    </svg>
                    í†µê³„
                </button>
            </div>
        </nav>
    </div>

    <script>
        // PWA ê´€ë ¨ ë³€ìˆ˜ë“¤
        let deferredPrompt;
        let isInstalled = false;
        
        // ì „ì—­ ë³€ìˆ˜
        let allRecords = [];
        let selectedRPE = null;
        let selectedStroke = null;
        let selectedSessionType = null;
        let userFeedback = {};
        
        // ìˆ˜ì˜ íŠ¹í™” RPE ì²™ë„ ë°ì´í„°
        const SWIMMING_RPE_SCALE = [
            { 
                value: 0, 
                title: "ì™„ì „ íœ´ì‹", 
                description: "í’€ì‚¬ì´ë“œì— ì•‰ì•„ ìˆëŠ” ìƒíƒœ, ë¬¼ì— ë“¤ì–´ê°€ê¸° ì „", 
                swimmingTip: "ì›Œë°ì—… ì „ ìƒíƒœ" 
            },
            { 
                value: 1, 
                title: "ë§¤ìš° ê°€ë³ê²Œ", 
                description: "ë¬¼ì— ë‘¥ë‘¥ ë–  ìˆê±°ë‚˜ ë§¤ìš° ì²œì²œíˆ ì›€ì§ì´ëŠ” ì •ë„", 
                swimmingTip: "ë¬¼ ì ì‘ì´ë‚˜ ì¿¨ë‹¤ìš´ ë‹¨ê³„" 
            },
            { 
                value: 2, 
                title: "ê°€ë³ê²Œ", 
                description: "í¸ì•ˆí•œ ì›Œë°ì—… ìˆ˜ì˜, í˜¸í¡ì´ ì „í˜€ í˜ë“¤ì§€ ì•ŠìŒ", 
                swimmingTip: "ì›Œë°ì—… ì´ˆê¸°, ììœ í˜•ìœ¼ë¡œ ì²œì²œíˆ" 
            },
            { 
                value: 3, 
                title: "ë³´í†µ", 
                description: "í¸ì•ˆí•œ í˜ì´ìŠ¤, ëŒ€í™”ê°€ ê°€ëŠ¥í•  ì •ë„ì˜ ê°•ë„", 
                swimmingTip: "ê¸°ë³¸ ìœ ì‚°ì†Œ êµ¬ê°„, ë¡± ë””ìŠ¤í„´ìŠ¤ ìˆ˜ì˜" 
            },
            { 
                value: 4, 
                title: "ì•½ê°„ í˜ë“¤ê²Œ", 
                description: "í˜¸í¡ì´ ì•½ê°„ ë¹¨ë¼ì§€ê¸° ì‹œì‘, í•˜ì§€ë§Œ ì—¬ì „íˆ í¸ì•ˆí•¨", 
                swimmingTip: "ì§€êµ¬ë ¥ í›ˆë ¨, ì¤‘ê±°ë¦¬ ì§€ì† ìˆ˜ì˜" 
            },
            { 
                value: 5, 
                title: "í˜ë“¤ê²Œ", 
                description: "í˜¸í¡ì´ ê¹Šì–´ì§€ê³  ë¹¨ë¼ì§, ê·¼ìœ¡ì—ì„œ ì•½ê°„ì˜ í”¼ë¡œê°", 
                swimmingTip: "í…œí¬ íŠ¸ë ˆì´ë‹, ë©”ì¸ ì„¸íŠ¸ ì‹œì‘" 
            },
            { 
                value: 6, 
                title: "ë” í˜ë“¤ê²Œ", 
                description: "í˜¸í¡ì´ í˜ë“¤ì–´ì§€ê³  ê·¼ìœ¡ í”¼ë¡œê° ì¦ê°€", 
                swimmingTip: "ì¸í„°ë²Œ íŠ¸ë ˆì´ë‹ ì¤‘ê°„ ê°•ë„" 
            },
            { 
                value: 7, 
                title: "ë§¤ìš° í˜ë“¤ê²Œ", 
                description: "í˜¸í¡ì´ ë§¤ìš° ê±°ì¹ ì–´ì§€ê³  ê·¼ìœ¡ì— ì –ì‚° ì¶•ì  ëŠë‚Œ", 
                swimmingTip: "ê³ ê°•ë„ ì¸í„°ë²Œ, ìŠ¤í”„ë¦°íŠ¸ í›ˆë ¨" 
            },
            { 
                value: 8, 
                title: "ê±°ì˜ ìµœëŒ€", 
                description: "ìˆ¨ì´ ë§¤ìš° ê°€ì˜ê³  ê·¼ìœ¡ì´ íƒ€ëŠ” ë“¯í•œ ëŠë‚Œ", 
                swimmingTip: "ìµœëŒ€ ìŠ¤í”„ë¦°íŠ¸ì— ê°€ê¹Œìš´ ê°•ë„" 
            },
            { 
                value: 9, 
                title: "ë§¤ìš° ë§¤ìš° í˜ë“¤ê²Œ", 
                description: "ê±°ì˜ í•œê³„ì— ê°€ê¹Œì›€, ëª‡ ë¯¸í„° ë”ë§Œ ê°€ëŠ¥", 
                swimmingTip: "ì˜¬ì•„ì›ƒ ìŠ¤í”„ë¦°íŠ¸ ë§‰íŒ" 
            },
            { 
                value: 10, 
                title: "ìµœëŒ€ ê°•ë„", 
                description: "ë” ì´ìƒ í•œ ìŠ¤íŠ¸ë¡œí¬ë„ í•  ìˆ˜ ì—†ëŠ” ìƒíƒœ", 
                swimmingTip: "25m/50m ìµœëŒ€ ìŠ¤í”„ë¦°íŠ¸ í”¼ë‹ˆì‹œ" 
            }
        ];

        // PWA ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }

        // PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ì²˜ë¦¬
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            showInstallPrompt();
        });

        // ì•±ì´ ì„¤ì¹˜ë˜ì—ˆëŠ”ì§€ í™•ì¸
        window.addEventListener('appinstalled', (evt) => {
            isInstalled = true;
            hideInstallPrompt();
            console.log('SwimRPE PWA ì„¤ì¹˜ ì™„ë£Œ');
        });

        // ì˜¨ë¼ì¸/ì˜¤í”„ë¼ì¸ ìƒíƒœ ê°ì§€
        window.addEventListener('online', () => {
            hideOfflineIndicator();
        });

        window.addEventListener('offline', () => {
            showOfflineIndicator();
        });

        // PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ í‘œì‹œ
        function showInstallPrompt() {
            const prompt = document.getElementById('install-prompt');
            // ì´ë¯¸ ì„¤ì¹˜ëœ ê²½ìš°ë‚˜ iOS Safariì¸ ê²½ìš° í‘œì‹œí•˜ì§€ ì•ŠìŒ
            if (!isInstalled && !isIOSSafari()) {
                prompt.classList.add('show');
            }
        }

        function hideInstallPrompt() {
            document.getElementById('install-prompt').classList.remove('show');
        }

        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('ì‚¬ìš©ìê°€ PWA ì„¤ì¹˜ë¥¼ ìŠ¹ì¸í–ˆìŠµë‹ˆë‹¤');
                    }
                    deferredPrompt = null;
                    hideInstallPrompt();
                });
            }
        }

        function dismissInstall() {
            hideInstallPrompt();
            // 24ì‹œê°„ í›„ ë‹¤ì‹œ í‘œì‹œ
            localStorage.setItem('installDismissed', Date.now() + 24 * 60 * 60 * 1000);
        }

        // iOS Safari ê°ì§€
        function isIOSSafari() {
            return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        }

        // ì˜¤í”„ë¼ì¸ ìƒíƒœ í‘œì‹œ
        function showOfflineIndicator() {
            document.getElementById('offline-indicator').classList.add('show');
        }

        function hideOfflineIndicator() {
            document.getElementById('offline-indicator').classList.remove('show');
        }

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ê´€ë¦¬
        class LocalStorage {
            static getRecords() {
                const records = localStorage.getItem('swimrpe_records');
                return records ? JSON.parse(records) : [];
            }

            static saveRecord(record) {
                const records = this.getRecords();
                record.id = Date.now();
                record.created_at = new Date().toISOString();
                records.unshift(record);
                localStorage.setItem('swimrpe_records', JSON.stringify(records));
                return record;
            }

            static getFeedback() {
                const feedback = localStorage.getItem('swimrpe_feedback');
                return feedback ? JSON.parse(feedback) : {};
            }

            static saveFeedback(feedback) {
                localStorage.setItem('swimrpe_feedback', JSON.stringify(feedback));
            }
        }

        // ì•± ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // ì˜¤ëŠ˜ ë‚ ì§œ ì„¤ì •
            document.getElementById('swim-date').value = new Date().toISOString().split('T')[0];
            
            // RPE ì²™ë„ ìƒì„±
            createRPEScale();
            createGuideRPEScale();
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            setupEventListeners();
            
            // ì´ˆê¸° ë°ì´í„° ë¡œë“œ
            loadDashboardData();
            
            // ì‚¬ìš©ì ID ì„¤ì • (ì„ì‹œ)
            window.currentUserId = 1;
            
            // ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ í™•ì¸
            checkInstallPrompt();
            
            console.log('SwimRPE PWAê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function checkInstallPrompt() {
            const dismissed = localStorage.getItem('installDismissed');
            if (dismissed && Date.now() < parseInt(dismissed)) {
                return; // ì•„ì§ í‘œì‹œí•˜ì§€ ì•ŠìŒ
            }
            
            // iOSì—ì„œëŠ” ë‹¤ë¥¸ ë©”ì‹œì§€ í‘œì‹œ
            if (isIOSSafari() && !isInstalled) {
                setTimeout(() => {
                    showIOSInstallGuide();
                }, 3000);
            }
        }

        function showIOSInstallGuide() {
            const guide = document.createElement('div');
            guide.className = 'install-prompt show';
            guide.innerHTML = `
                iOSì—ì„œ í™ˆí™”ë©´ì— ì¶”ê°€í•˜ë ¤ë©´:<br>
                ê³µìœ  ë²„íŠ¼(â¬†ï¸) â†’ "í™ˆ í™”ë©´ì— ì¶”ê°€" ì„ íƒ
                <button onclick="this.parentElement.remove()">í™•ì¸</button>
            `;
            document.body.appendChild(guide);
            
            setTimeout(() => guide.remove(), 8000);
        }

        function createRPEScale() {
            const container = document.getElementById('rpe-scale');
            container.innerHTML = SWIMMING_RPE_SCALE.map(rpe => `
                <div class="rpe-item" data-rpe="${rpe.value}" onclick="selectRPE(${rpe.value})">
                    <div class="rpe-number">${rpe.value}</div>
                    <div class="rpe-description">
                        <div class="rpe-title">${rpe.title}</div>
                        <div class="rpe-detail">${rpe.description}</div>
                        <div class="rpe-swimming-tip">${rpe.swimmingTip}</div>
                    </div>
                </div>
            `).join('');
        }

        function createGuideRPEScale() {
            const container = document.getElementById('guide-rpe-scale');
            container.innerHTML = SWIMMING_RPE_SCALE.map(rpe => `
                <div class="rpe-item">
                    <div class="rpe-number">${rpe.value}</div>
                    <div class="rpe-description">
                        <div class="rpe-title">${rpe.title}</div>
                        <div class="rpe-detail">${rpe.description}</div>
                        <div class="rpe-swimming-tip">${rpe.swimmingTip}</div>
                    </div>
                </div>
            `).join('');
        }

        function selectRPE(value) {
            // ì´ì „ ì„ íƒ ì œê±°
            document.querySelectorAll('.rpe-item[data-rpe]').forEach(item => {
                item.classList.remove('selected');
            });
            
            // ìƒˆ ì„ íƒ ì ìš©
            const selectedItem = document.querySelector(`[data-rpe="${value}"]`);
            if (selectedItem) {
                selectedItem.classList.add('selected');
                selectedRPE = value;
            }
        }

        function setupEventListeners() {
            // ìˆ˜ì˜ ê¸°ë¡ í¼ ì œì¶œ
            document.getElementById('swimming-form').addEventListener('submit', handleSwimmingSubmit);
            
            // ì˜ë²• ì„ íƒ
            document.querySelectorAll('.stroke-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.stroke-item').forEach(i => i.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedStroke = this.dataset.stroke;
                });
            });
            
            // ì„¸ì…˜ íƒ€ì… ì„ íƒ
            document.querySelectorAll('.session-type-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.session-type-item').forEach(i => i.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedSessionType = this.dataset.session;
                });
            });
            
            // í”¼ë“œë°± ì„ íƒ
            document.querySelectorAll('.feedback-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.feedback-item').forEach(i => i.classList.remove('selected'));
                    this.classList.add('selected');
                    submitFeedback(this.dataset.feedback);
                });
            });
            
            // ê²€ìƒ‰ ë° í•„í„°
            document.getElementById('search-records').addEventListener('input', filterRecords);
            document.getElementById('filter-stroke').addEventListener('change', filterRecords);
        }

        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            // ëª¨ë“  íƒ­ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ëª¨ë“  ë„¤ë¹„ê²Œì´ì…˜ ë¹„í™œì„±í™”
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            document.getElementById(`${tabName}-tab`).classList.add('active');
            event.target.closest('.nav-tab').classList.add('active');
            
            // íƒ­ë³„ ë°ì´í„° ë¡œë“œ
            switch(tabName) {
                case 'home':
                    loadDashboardData();
                    break;
                case 'records':
                    loadAllRecords();
                    break;
                case 'stats':
                    loadStatistics();
                    break;
            }
        }

        // ì„œë¸Œíƒ­ ì „í™˜ (í™ˆ íƒ­ ë‚´ë¶€)
        function switchSubTab(subtabName) {
            // ì„œë¸Œíƒ­ ë²„íŠ¼ ìƒíƒœ ë³€ê²½
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // ì„œë¸Œíƒ­ ì»¨í…ì¸  ì „í™˜
            document.querySelectorAll('.subtab-content').forEach(subtab => {
                subtab.style.display = 'none';
            });
            document.getElementById(`${subtabName}-subtab`).style.display = 'block';
        }

        // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ
        function loadDashboardData() {
            const records = LocalStorage.getRecords();
            updateDashboardStats(records);
            displayRecentRecords(records.slice(0, 5));
        }

        // ëŒ€ì‹œë³´ë“œ í†µê³„ ì—…ë°ì´íŠ¸
        function updateDashboardStats(records) {
            const today = new Date().toDateString();
            const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);
            
            const todayRecords = records.filter(r => 
                new Date(r.date).toDateString() === today
            );
            
            const weeklyRecords = records.filter(r => 
                new Date(r.date) >= weekAgo
            );
            
            // ì˜¤ëŠ˜ í‰ê·  RPE
            const todayAvgRPE = todayRecords.length > 0 
                ? Math.round(todayRecords.reduce((sum, r) => sum + r.intensity, 0) / todayRecords.length * 10) / 10
                : 0;
            
            // ì£¼ê°„ ì¼ê´€ì„± (ìš´ë™í•œ ë‚ ìˆ˜ / 7ì¼ * 100)
            const weeklyDays = new Set(weeklyRecords.map(r => 
                new Date(r.date).toDateString()
            )).size;
            const consistency = Math.round(weeklyDays / 7 * 100);
            
            // ì—°ì† ê¸°ë¡ì¼ ê³„ì‚°
            const streakDays = calculateStreakDays(records);
            
            // DOM ì—…ë°ì´íŠ¸
            document.getElementById('today-avg-rpe').textContent = todayAvgRPE;
            document.getElementById('today-sessions').textContent = todayRecords.length;
            document.getElementById('weekly-consistency').textContent = consistency + '%';
            document.getElementById('streak-days').textContent = streakDays + 'ì¼';
        }

        // ì—°ì† ê¸°ë¡ì¼ ê³„ì‚°
        function calculateStreakDays(records) {
            if (records.length === 0) return 0;
            
            const dates = [...new Set(records.map(r => 
                new Date(r.date).toDateString()
            ))].sort((a, b) => new Date(b) - new Date(a));
            
            let streak = 0;
            const today = new Date().toDateString();
            const yesterday = new Date(Date.now() - 24 * 60 * 60 * 1000).toDateString();
            
            // ì˜¤ëŠ˜ ë˜ëŠ” ì–´ì œë¶€í„° ì‹œì‘í•˜ëŠ”ì§€ í™•ì¸
            if (dates[0] === today || dates[0] === yesterday) {
                streak = 1;
                
                for (let i = 1; i < dates.length; i++) {
                    const currentDate = new Date(dates[i-1]);
                    const nextDate = new Date(dates[i]);
                    const daysDiff = (currentDate - nextDate) / (24 * 60 * 60 * 1000);
                    
                    if (daysDiff === 1) {
                        streak++;
                    } else {
                        break;
                    }
                }
            }
            
            return streak;
        }

        // ìµœê·¼ ê¸°ë¡ í‘œì‹œ
        function displayRecentRecords(records) {
            const container = document.getElementById('recent-records');
            
            if (records.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>ì•„ì§ ìˆ˜ì˜ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                        <p>ì²« ë²ˆì§¸ ìˆ˜ì˜ ì„¸ì…˜ì„ ê¸°ë¡í•´ë³´ì„¸ìš”!</p>
                        <button class="btn btn-primary" onclick="switchTab('input')">
                            ìˆ˜ì˜ ê¸°ë¡í•˜ê¸°
                        </button>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = records.map(record => {
                const strokeEmoji = getStrokeEmoji(record.exercise_type);
                const sessionType = extractSessionType(record.memo || '');
                
                return `
                    <div class="record-item">
                        <div class="record-info">
                            <h4>${strokeEmoji} ${record.exercise_type}</h4>
                            <p>${formatDate(record.date)} ${record.time_of_day}</p>
                            ${sessionType ? `<div class="record-tags"><span class="record-tag">${sessionType}</span></div>` : ''}
                            ${record.memo ? `<p style="font-style: italic; margin-top: 8px; color: var(--text-secondary);">${record.memo}</p>` : ''}
                        </div>
                        <div class="record-rpe">RPE ${record.intensity}</div>
                    </div>
                `;
            }).join('');
        }

        // ì˜ë²• ì´ëª¨ì§€ ë°˜í™˜
        function getStrokeEmoji(exerciseType) {
            const emojiMap = {
                'ììœ í˜•': 'ğŸŠ',
                'ë°°ì˜': 'ğŸŠâ€â™‚ï¸', 
                'í‰ì˜': 'ğŸŠâ€â™€ï¸',
                'ì ‘ì˜': 'ğŸ¦‹',
                'í˜¼ì˜': 'ğŸŠ',
                'ê¸°íƒ€': 'ğŸ’ª'
            };
            return emojiMap[exerciseType] || 'ğŸŠ';
        }

        // ë©”ëª¨ì—ì„œ ì„¸ì…˜ íƒ€ì… ì¶”ì¶œ
        function extractSessionType(memo) {
            if (memo.includes('ì›œì—…') || memo.includes('ì›Œë°ì—…')) return 'ì›œì—…';
            if (memo.includes('ë©”ì¸') || memo.includes('ë©”ì¸ì„¸íŠ¸')) return 'ë©”ì¸ ì„¸íŠ¸';
            if (memo.includes('ì¿¨ë‹¤ìš´') || memo.includes('ì •ë¦¬')) return 'ì¿¨ë‹¤ìš´';
            return null;
        }

        // ìˆ˜ì˜ ê¸°ë¡ ì œì¶œ ì²˜ë¦¬
        async function handleSwimmingSubmit(e) {
            e.preventDefault();
            
            // í•„ìˆ˜ ì„ íƒì‚¬í•­ ê²€ì¦
            if (!selectedStroke) {
                showStatus('input-status', 'error', 'ìˆ˜ì˜ ì˜ë²•ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (!selectedSessionType) {
                showStatus('input-status', 'error', 'ì„¸ì…˜ ìœ í˜•ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (selectedRPE === null) {
                showStatus('input-status', 'error', 'RPE ê°•ë„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            showStatus('input-status', 'loading', 'ìˆ˜ì˜ ê¸°ë¡ì„ ì €ì¥í•˜ëŠ” ì¤‘...');
            
            const distance = document.getElementById('swim-distance').value;
            const memo = document.getElementById('swim-memo').value;
            
            // ë©”ëª¨ì— ì¶”ê°€ ì •ë³´ í¬í•¨
            const enrichedMemo = `${selectedSessionType}${distance ? ` | ${distance}m` : ''}${memo ? ` | ${memo}` : ''}`;
            
            const formData = {
                user_id: window.currentUserId,
                exercise_type: selectedStroke,
                date: document.getElementById('swim-date').value,
                time_of_day: document.getElementById('swim-time').value,
                intensity: selectedRPE,
                memo: enrichedMemo
            };
            
            try {
                // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                const savedRecord = LocalStorage.saveRecord(formData);
                
                showStatus('input-status', 'success', 
                    `ìˆ˜ì˜ ê¸°ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\n${selectedStroke} (${selectedSessionType}) - RPE ${selectedRPE}`);
                
                // í¼ ì´ˆê¸°í™”
                resetForm();
                
                // ëŒ€ì‹œë³´ë“œ ìƒˆë¡œê³ ì¹¨
                setTimeout(() => {
                    loadDashboardData();
                }, 1000);
                
            } catch (error) {
                showStatus('input-status', 'error', `ì €ì¥ ì‹¤íŒ¨: ${error.message}`);
            }
        }

        // í¼ ì´ˆê¸°í™”
        function resetForm() {
            document.getElementById('swimming-form').reset();
            document.getElementById('swim-date').value = new Date().toISOString().split('T')[0];
            
            // ì„ íƒ ìƒíƒœ ì´ˆê¸°í™”
            document.querySelectorAll('.stroke-item, .session-type-item, .rpe-item[data-rpe]').forEach(item => {
                item.classList.remove('selected');
            });
            
            selectedRPE = null;
            selectedStroke = null;
            selectedSessionType = null;
        }

        // í”¼ë“œë°± ì œì¶œ
        function submitFeedback(feedbackType) {
            try {
                // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— í”¼ë“œë°± ì €ì¥
                const feedback = LocalStorage.getFeedback();
                feedback[new Date().toISOString()] = feedbackType;
                LocalStorage.saveFeedback(feedback);
                
                showStatus('feedback-status', 'success', 'ì†Œì¤‘í•œ í”¼ë“œë°± ê°ì‚¬í•©ë‹ˆë‹¤!');
                
                setTimeout(() => {
                    document.getElementById('feedback-status').innerHTML = '';
                }, 3000);
                
            } catch (error) {
                showStatus('feedback-status', 'error', 'í”¼ë“œë°± ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ëª¨ë“  ê¸°ë¡ ë¡œë“œ
        function loadAllRecords() {
            allRecords = LocalStorage.getRecords();
            filterRecords();
        }

        // ê¸°ë¡ í•„í„°ë§
        function filterRecords() {
            const searchTerm = document.getElementById('search-records').value.toLowerCase();
            const filterStroke = document.getElementById('filter-stroke').value;
            
            let filtered = allRecords.filter(record => {
                const matchesSearch = searchTerm === '' || 
                    record.exercise_type.toLowerCase().includes(searchTerm) ||
                    (record.memo && record.memo.toLowerCase().includes(searchTerm));
                
                const matchesStroke = filterStroke === '' || record.exercise_type === filterStroke;
                
                return matchesSearch && matchesStroke;
            });
            
            displayFilteredRecords(filtered);
        }

        // í•„í„°ë§ëœ ê¸°ë¡ í‘œì‹œ
        function displayFilteredRecords(records) {
            const container = document.getElementById('records-list');
            
            if (records.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>í•´ë‹¹í•˜ëŠ” ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                        <p>ê²€ìƒ‰ì–´ë‚˜ í•„í„°ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = records.map(record => {
                const strokeEmoji = getStrokeEmoji(record.exercise_type);
                const sessionType = extractSessionType(record.memo || '');
                
                return `
                    <div class="card">
                        <div class="record-item">
                            <div class="record-info">
                                <h4>${strokeEmoji} ${record.exercise_type}</h4>
                                <p>${formatDate(record.date)} ${record.time_of_day}</p>
                                ${sessionType ? `<div class="record-tags"><span class="record-tag">${sessionType}</span></div>` : ''}
                                ${record.memo ? `<p style="margin-top: 12px; font-style: italic; color: var(--text-secondary);">${record.memo}</p>` : ''}
                            </div>
                            <div class="record-rpe">RPE ${record.intensity}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // í†µê³„ ë¡œë“œ
        function loadStatistics() {
            const records = LocalStorage.getRecords();
            updateStatistics(records);
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStatistics(records) {
            if (records.length === 0) {
                document.getElementById('total-sessions').textContent = '0';
                document.getElementById('avg-rpe-all').textContent = '0';
                document.getElementById('favorite-stroke').textContent = '-';
                document.getElementById('best-time').textContent = '-';
                return;
            }
            
            // ê¸°ë³¸ í†µê³„
            const totalSessions = records.length;
            const avgRPE = Math.round(records.reduce((sum, r) => sum + r.intensity, 0) / records.length * 10) / 10;
            
            // ì„ í˜¸ ì˜ë²•
            const strokeCount = records.reduce((acc, record) => {
                acc[record.exercise_type] = (acc[record.exercise_type] || 0) + 1;
                return acc;
            }, {});
            const favoriteStroke = Object.keys(strokeCount).reduce((a, b) => 
                strokeCount[a] > strokeCount[b] ? a : b, '-');
            
            // ìµœì  ì‹œê°„ëŒ€
            const timeCount = records.reduce((acc, record) => {
                acc[record.time_of_day] = (acc[record.time_of_day] || 0) + 1;
                return acc;
            }, {});
            const bestTime = Object.keys(timeCount).reduce((a, b) => 
                timeCount[a] > timeCount[b] ? a : b, '-');
            
            document.getElementById('total-sessions').textContent = totalSessions;
            document.getElementById('avg-rpe-all').textContent = avgRPE;
            document.getElementById('favorite-stroke').textContent = favoriteStroke;
            document.getElementById('best-time').textContent = bestTime;
            
            // ì˜ë²•ë³„ ë¶„í¬
            displayDistribution('stroke-distribution', strokeCount);
            
            // ì‹œê°„ëŒ€ë³„ ë¶„í¬
            displayDistribution('time-distribution', timeCount);
        }

        // ë¶„í¬ ì°¨íŠ¸ í‘œì‹œ
        function displayDistribution(containerId, data) {
            const container = document.getElementById(containerId);
            const total = Object.values(data).reduce((sum, val) => sum + val, 0);
            
            if (total === 0) {
                container.innerHTML = '<div class="empty-state">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
                return;
            }
            
            container.innerHTML = Object.entries(data).map(([key, value]) => {
                const percentage = Math.round(value / total * 100);
                const emoji = containerId === 'stroke-distribution' ? getStrokeEmoji(key) : '';
                
                return `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <span style="font-weight: 600; color: var(--text-primary);">${emoji} ${key}</span>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="width: 120px; height: 12px; background: var(--border-light); border-radius: 6px; overflow: hidden;">
                                <div style="width: ${percentage}%; height: 100%; background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); border-radius: 6px;"></div>
                            </div>
                            <span style="font-size: 14px; color: var(--text-secondary); min-width: 60px; font-weight: 600;">${value}íšŒ (${percentage}%)</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ì„œë²„ ìƒíƒœ í™•ì¸
        function checkServerHealth() {
            const statusDiv = document.getElementById('server-status');
            showStatus('server-status', 'loading', 'ë¡œì»¬ ì €ì¥ì†Œ ìƒíƒœë¥¼ í™•ì¸í•˜ëŠ” ì¤‘...');
            
            setTimeout(() => {
                try {
                    const records = LocalStorage.getRecords();
                    const feedback = LocalStorage.getFeedback();
                    
                    showStatus('server-status', 'success', 
                        `ë¡œì»¬ ì €ì¥ì†Œ ì •ìƒ ì‘ë™ ì¤‘\nì €ì¥ëœ ê¸°ë¡: ${records.length}ê°œ\ní”¼ë“œë°± ìˆ˜: ${Object.keys(feedback).length}ê°œ`);
                    
                } catch (error) {
                    showStatus('server-status', 'error', 'ë¡œì»¬ ì €ì¥ì†Œ ì ‘ê·¼ ì‹¤íŒ¨\në¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                }
            }, 1000);
        }

        // ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ
        function showStatus(containerId, type, message) {
            const container = document.getElementById(containerId);
            const className = `status-${type}`;
            
            let content = message;
            if (type === 'loading') {
                content = `<div class="loading-spinner"></div> ${message}`;
            }
            
            container.innerHTML = `<div class="${className} status-message" style="white-space: pre-line;">${content}</div>`;
        }

        // ë‚ ì§œ í¬ë§·íŒ…
        function formatDate(dateString) {
            if (!dateString) return '';
            const date = new Date(dateString);
            return date.toLocaleDateString('ko-KR', {
                month: 'long',
                day: 'numeric',
                weekday: 'short'
            });
        }
    </script>
</body>
</html>
